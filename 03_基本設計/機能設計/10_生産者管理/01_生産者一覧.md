# 生産者一覧 機能仕様

## 1. 概要
- **目的**: 生産者（施設）を横断検索し、現在の提出状況やステータスを一覧で把握できるようにする。
- **対象画面**: `03_生産者一覧`。
- **前提**: 認証済みユーザーのみアクセス可能。Laravel + Bladeでレンダリング。

## 2. 主なユースケース
1. 生産者名や鳥種、地域ブロックで検索し該当生産者を素早く探す。
2. 最終提出日や提出ステータスを一覧で確認し、未提出・警告ありの生産者を抽出する。
3. 対象生産者の詳細編集やデータ提出（CSV/手入力）に遷移する。

## 3. 入出力
| 区分 | 項目 | 内容 |
| --- | --- | --- |
| 入力（検索条件） | 生産者名キーワード | 部分一致／大文字小文字無視。生産者名カナも対象。 |
| 入力（検索条件） | 鳥種 | 全て／ブロイラー／成鶏／地鶏。 |
| 入力（検索条件） | 地域ブロック | 全て／A〜F。 |
| 出力 | 一覧データ | 施設ID、生産者名、鳥種、地域ブロック、特記事項有無。 |
| 出力 | ページ情報 | 件数、ページ番号、総ページ数。 |

## 4. ロジック
- **検索処理**: `facilities` をベースに、施設名/カナ・鳥種・地域ブロックでフィルタする。検索はEloquentクエリビルダで実装。
- **特記事項有無**: メモが存在する場合にアイコン表示（真偽値）。
- **並び替え**: デフォルトは生産者名昇順。
- **ページング**: 20件／ページ。Laravelのページネータを使用。
- **ショートカット遷移**: 行アクションから各画面へ `facility_id` をクエリパラメータで付与。

## 5. バリデーション
- 生産者名検索は最大100文字まで。
- 鳥種・地域ブロックは定義済みマスタ値と一致するもののみ許可。
- ページ番号は正の整数。範囲外指定は最終ページを返却。

## 6. 例外・エラー処理
- データ取得失敗時は「生産者情報の取得に失敗しました。再度お試しください。」を表示し、`storage/logs/laravel.log` にスタックトレースを出力。
- 提出履歴参照で異常があった場合はステータス列に「取得エラー」と表示し、詳細操作時に再取得を試みる。

## 7. 今後の拡張
- ステータスフィルタに「廃業」「合併中」などを追加。
