# グローバルヘッダー 機能仕様

## 1. 概要
- **目的**: 主要機能への導線を一元化し、どの画面からでも迷わず目的の操作に到達できるナビゲーションを提供する。
- **対象画面**: ログインを除く全画面 (`02`〜`12`) に共通表示。
- **構成要素**: 左上ロゴ、主要カテゴリボタン、ドロップダウンメニュー、右上アクション（ログアウト）。

## 2. UI構成
| エリア | 要素 | 内容 | 遷移先 |
| --- | --- | --- | --- |
| 左 | ロゴ | システム名ロゴを表示。クリックでダッシュボードへ。 | `02_管理ダッシュボード` |
| 中央 | 生産者管理 | 「生産者一覧」を表示。 | `03_生産者一覧` |
| 中央 | ドロップダウン: データ提出 | 「CSVアップロード」「手入力登録」「提出履歴詳細一覧」「月次提出状況」。 | `06`, `07`, `09`, `10` |
| 中央 | ドロップダウン: 集計・出力 | 「月次/年次レポート」「関係機関連携エクスポート」。 | `11`, `12` |
| 右 | ボタン: ログアウト | クリックでセッション破棄→ログイン画面へ。 | `01_ログイン` |

## 3. 表示・非表示条件
- ログイン画面ではヘッダー非表示。
- 認証済みセッションが無い場合、ヘッダー描画前にログイン画面へリダイレクト。

## 4. 操作フロー
1. コントローラで現在ログイン中のユーザー情報・パンくず構成・メニュー定義をBladeへ渡す。
2. Blade側でメニューをレンダリングし、カテゴリごとのリンクを設定。
3. メニュー項目選択でLaravelのルーティングに従い対象画面へ遷移。
4. ログアウト押下で `POST /logout`（Laravel標準）を呼び出し、セッション破棄後にログイン画面へリダイレクト。

## 5. 状態管理
- パンくずリストをヘッダー直下（または同一エリア内）に表示し、`ホーム > 生産者管理 > 生産者詳細` の形式で現在位置を明示する。  
  - ルート情報は Blade レイヤーでコントローラから受け取る。  
  - パンくず末尾はリンク無効（現在ページ）とする。
- ドロップダウン開閉状態は画面遷移時にリセット。
- 将来的な権限区分導入に備え、メニュー表示可否をユーザー権限で判定できる設計にする。

## 6. 例外・エラー
- ルーティング不一致や内部エラーで画面遷移に失敗した場合、トーストで「画面遷移に失敗しました。再度お試しください。」を表示し、必要に応じてログを出力。
- セッション切れが発生した場合はミドルウェアがログイン画面へリダイレクトし、再ログインを促す。

## 7. 関連機能
- 認証: セッション状態に依存するため `共通管理者認証` と連携。
- アクセスログ: 主要メニュー操作は操作ログとして記録し、利用状況分析や監査に活用できるようにする（任意）。

## 8. 今後の拡張
- 通知アイコンの追加（未提出や警告をヘッダー上でバッジ表示）。
- ユーザープロファイルメニュー（個別アカウント導入時）への発展。
