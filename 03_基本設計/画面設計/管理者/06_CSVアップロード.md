# CSVアップロード画面

## 1. 画面概要
- 目的: 工場単位または複数工場分の月次データをCSVから取り込み、形式・項目・数値の妥当性検証を実施した上で登録に進む。
- 主利用者: 食鳥協会職員。
- 画面カテゴリ: データ提出。

## 2. 主なフロー
### 個別アップロード
1. 工場を検索し1件選択。
2. 対象月を指定。
3. CSVファイルをアップロード。
4. 検証結果を確認し、問題なければ入力確認画面へ進む。

### 一括アップロード
1. 対象月を指定。
2. 複数工場分を含む標準フォーマットCSVをアップロード（工場識別子を含む）。
3. 検証結果テーブルで工場ごとのステータスを確認。
4. 正常なレコードのみまとめて入力確認画面へ進み、エラー行は再アップロードで対応。

## 3. 画面要素
| ID | 項目 | 種別 | 必須 | 検証・挙動 |
| --- | --- | --- | --- | --- |
| TAB-UP-01 | アップロードモード | タブ | 必須 | 「個別」「一括」を切替。 |
| SEL-UP-01 | 工場選択（個別） | サイド検索 + リスト | 個別時必須 | 工場名・鳥種・地域ブロックで検索。選択は1件のみ。 |
| SEL-UP-02 | 提出月 | 月選択 | 必須 | YYYY-MM形式。未来3ヶ月先まで選択可能。 |
| FLD-UP-01 | CSVファイル | ファイル選択 | 必須 | 拡張子.csv、文字コードUTF-8。 |
| BTN-UP-01 | アップロード開始 | ボタン | - | ファイル選択後に活性化、即時検証を実行。 |
| TABLE-UP-01 | 検証結果一覧 | テーブル | - | 行単位で工場名/項目/ステータス（OK/警告/エラー）を表示。 |
| BTN-UP-02 | 確認へ進む | ボタン | - | エラーが0件の行のみ対象に入力確認画面へ進む。 |
| BTN-UP-03 | エラー行ダウンロード | ボタン | 任意 | エラー行のみCSV出力し再修正を容易にする。 |
| BTN-UP-04 | キャンセル | ボタン | - | 生産者一覧またはデータ提出メニューへ戻る。 |

## 4. 検証ルール
- ファイル形式: ヘッダー一致、列数チェック。
- 項目検証: 鳥種ごとに必要項目が揃っているか（ブロイラーは翌月以降予定含む等）。
- 数値範囲: 負値禁止、桁数チェック。
- 比較検証: 導入羽数 < 処理羽数の場合は警告、前年度同月比±30%を超える際に警告。
- 一括時は工場識別子（IDまたは工場コード）の存在を必須とし、未登録工場行はエラーとする。

## 5. メッセージ仕様
- エラー: 「工場ID: XXX の翌月予定が未入力です」など具体的項目名と対象行を表示。
- 警告: 黄色アイコン表示、続行可能。
- 成功: 「検証が完了しました。確認画面へ進んでください。」

## 6. 遷移
- 確認へ進む → 入力確認画面（正常行のみを保持して遷移）。
- エラー行ダウンロード → エラー内容付きCSVをダウンロード。
- キャンセル → 生産者一覧（選択状態は破棄）。

## 7. 備考
- Googleフォーム経由で取得したCSVを想定し、個別・一括どちらのフォーマットもシステム側で吸収する。
- アップロード履歴は提出履歴詳細画面で参照可能にする。
