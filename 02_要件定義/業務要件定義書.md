# 日本食鳥協会様 業務要件定義書

## システム名：⽻数調査集積システム

## 1. システム概要と運用フロー

### 1.1 基本運用フロー
**主要利用者**: 食鳥協会職員（全職員がAdmin権限）

#### メインフロー
1. **生産者アカウント作成**（職員が実施）
   - 生産者情報をもとに生産者アカウントを作成
   - 会社情報 + 申請者情報をシステムに登録
   - **初期データで挿入する**

2. **月次データ提出**（職員が代理実施）
   - 職員が管理画面で生産者を選択
   - 鳥種別に絞り込み可能（ブロイラー・成鶏・地鶏）
   - CSVファイルのアップロード / 個別対応として画面から手入力
   - 確認画面でデータ内容をチェック後、確定
     - **数**値の修正も確認画面で可能

3. **データ管理・集計**
   - 月次・年次レポート生成
   - 地域ブロック別集計
   - 関係機関向けデータエクスポート
   - 鳥種別や地域ごとなどで集計したデータをエクスポート
     - 各会員に配布しデータ提供

### 1.2 Googleフォーム連携フロー
1. **申請者がGoogleフォーム入力**
   - 申請者情報（氏名、部署、電話番号）
   - 会社情報（会社名、住所、代表者名）
   - 管理鳥種の選択

2. **スプレッドシート自動記録**
   - Googleフォーム送信時に自動でスプレッドシートに記録

3. **職員による取り込み**
   - スプレッドシートからエクセルエクスポート
   - エクスポートしたファイルをCSV形式でシステムにアップロード
    - 一気に取り込む

4. **FAXや個別対応**
   - ご年配の方への考慮として職員による代理入力も可能

### 1.3 将来拡張計画
#### フェーズ1（当面）
- 職員による代理アップロードのみ

#### フェーズ2（将来拡張）
- **ブロイラー生産者ログイン機能**
  - 生産者自身がシステムにログイン
  - CSVアップロード機能
  - 手入力でのデータ登録機能
  - アップロード後は職員による認証が必要

#### フェーズ3（最終目標）
- **全鳥種生産者ログイン対応**
- **Webフォーム入力機能**
  - CSVアップロードに加えて画面上での手入力対応
  - 生産者向けの個別データ集計画面
    - 過去のデータ参照機能
    - 地域別や鳥種ごとの全体の数値確認など
- **会員情報機能**
  - 企業情報登録・編集機能
  - 申請者情報登録・編集機能

## 2. 会員登録要件

### 2.1 登録情報の違い

#### ブロイラー・地鶏生産者
- **メールアドレス**（必須）
- **会社情報**（必須）
  - 会社名
  - 会社住所（都道府県・市区町村・番地）
    - **工場名で登録・ここで判断している**
  - 代表者名（社長または家族経営の代表者）
    - ここはなし
- **申請者情報**（必須）
  - 申請者氏名
  - 申請者部署名（任意）
  - 申請者電話番号

#### 成鶏生産者
- **メールアドレス**（必須）
- **会社情報**（必須）
  - 会社名
  - 会社住所（都道府県・市区町村・番地）
    - **工場名で登録・ここで判断している**
  - 代表者名（社長または家族経営の代表者）
- **申請者情報**（必須）
  - 申請者氏名
  - 申請者電話番号

### 2.2 申請者管理
- 会社の代表者とは別に、実際にデータを申請する担当者を登録
- **職員による代理登録**がフェーズ１（現フェーズ）のメインフロー
- 同一会社で複数の申請者が存在する可能性がある

## 3. 職員向け機能要件

### 3.1 生産者管理機能
- **生産者一覧表示**
  - 会社名での文字列検索
  - 鳥種別フィルタリング（ブロイラー・成鶏・地鶏）
  - 地域ブロック別フィルタリング
  - 最終データ提出日表示

- **生産者登録・編集**
  - 個別登録フォーム
  - 登録情報の修正・更新
  - 生産者用特記事項メモ（オプション）
    - ご高齢のためFAXや電話で聞き取り代理申請など必要情報のメモ

### 3.2 データ提出管理機能
- **CSVアップロード**
  - 生産者選択（検索・フィルタ機能付き）
  - ファイル形式チェック
  - データ妥当性検証
  - 確認画面での最終チェック

- **手入力での登録**
  - 生産者選択（検索・フィルタ機能付き）
  - 各項目の入力
  - データ妥当性検証
  - 確認画面での最終チェック

- **提出状況管理**
  - 月次提出状況一覧
  - 未提出者リスト
  - 提出履歴管理

### 3.3 権限管理
- **全職員Admin権限**
  - 全鳥種データの閲覧・編集
  - 全生産者情報の管理
  - レポート生成・エクスポート
  - システム設定変更
  - **共通アカウント1つで運用**

## 4. データ項目の詳細

### 4.1 ブロイラー
| 項目名 | 単位 | 先月実績 | 翌月予定 | 翌々月予定 | 3ヶ月後予定 |
|--------|------|----------|----------|------------|-------------|
| ひな入雛羽数 | 千羽 | ○ | ○ | ○ | ○ |
| 生体処理羽数 | 千羽 | ○ | ○ | ○ | ○ |
| 生体処理重量 | トン | ○ | ○ | ○ | ○ |

**生体処分別実羽数**（先月実績のみ）
- 禁止（羽数）
- 全部廃棄（羽数）
- 一部廃棄（羽数）

**その他**
- コメント（自由記述）

### 4.2 地鶏
| 項目名 | 単位 | 先月実績 |
|--------|------|----------|
| 生体処理羽数 | 千羽 | ○ |
| 生体処理重量 | トン | ○ |

**生体処分別実羽数**（先月実績のみ）
- 禁止（羽数）
- 全部廃棄（羽数）
- 一部廃棄（羽数）

**その他**
- コメント（自由記述）

### 4.3 成鶏（採卵鶏）
| 項目名 | 単位 | 先月実績 |
|--------|------|----------|
| 生体処理羽数 | 千羽 | ○ |

**生体処分別実羽数**（先月実績のみ）
- 禁止（羽数）
- 全部廃棄（羽数）
- 一部廃棄（羽数）

**その他**
- コメント（自由記述）

## 5. 地域ブロック分け

関係機関への報告のため、都道府県を以下の6ブロックに分類：

### Aブロック：北海道・東北地区
- 北海道、青森、岩手、宮城、秋田、山形、福島

### Bブロック：関東地区
- 茨城、群馬、埼玉、千葉、東京、神奈川、山梨

### Cブロック：中部地区
- 新潟、富山、石川、福井、長野、岐阜、静岡、愛知、三重

### Dブロック：近畿・中部・四国地区
- 滋賀、京都、大阪、兵庫、奈良、和歌山、鳥取、島根、岡山、広島、徳島、香川、愛媛、高知、山口

### Eブロック：北部九州地区
- 福岡、佐賀、長崎、熊本、大分

### Fブロック：南九州地区
- 宮崎、鹿児島、沖縄

## 6. システム要件

### 6.1 会員管理
- 会社情報と申請者情報を分離して管理
- 1つの会社に複数の申請者を登録可能
  - **原則担当者は同じ（以前の担当者さんの履歴は残す）**
- **職員による代理アカウント管理**がメイン機能

### 6.2 データ提出管理
- 月次データ提出時に職員と対象生産者を記録
- 提出履歴の管理（職員が誰の代理でいつ提出したか）
- 修正・再提出の履歴管理
  - **項目ごとに編集履歴を保存**
- **確認画面での入力チェック機能**

### 編集履歴
2025/9/19 15:00 羽数関連を１５から２０に変更

### 6.3 集計・レポート
- 地域ブロック別の自動集計
- 品種別の集計フォーマット対応
- 関係機関提出用フォーマットの自動生成

## 7. 単位と数値の扱い

### 7.1 入力単位
- **羽数関連**：千羽単位（小数点第1位まで）
- **重量関連**：トン単位（小数点第1位まで）
- **処分別実羽数**：羽単位

### 7.2 データ検証
- 負の値は入力不可
- 合理的な範囲のチェック（異常値の警告）
  - 生産者さんが桁を間違えて提出するパターンがある
  - 桁が多かったり少なくなったりする場合に警告
- 前年度のデータとの比較による妥当性チェック
  - 前年度の同じ月のデータと比較したい

## 8. 職員向けワークフロー詳細

### 8.1 生産者アカウント作成ワークフロー

#### 個別登録フロー
1. **事前準備**
   - 申請者から提出された書類（メール、郵送、FAX等）を確認
   - 必要な会社情報と申請者情報を整理

2. **システム登録手順**
   - 管理画面「生産者管理」→「新規登録」をクリック
   - **基本情報入力**
     - 会社名、会社名カナ（検索用）
     - 鳥種選択（ブロイラー・成鶏・地鶏）
     - 事業者種別（企業・個人・家族経営）
   - **所在地情報入力**
     - 郵便番号（自動住所補完）
     - 都道府県選択（地域ブロック自動設定）
     - 市区町村、番地
   - **代表者・申請者情報入力**
     - 代表者名
     - 申請者氏名、部署（任意）、電話番号
     - メールアドレス

3. **確認・登録**
   - 入力内容確認画面で最終チェック
   - 「登録」ボタンで確定

### 8.2 CSVアップロードワークフロー

#### 事前準備
1. **生産者からのデータ受領**
   - Googleフォームでデータを受領
   - 提出期限管理（15日締切）
   - 未提出者リストで漏れをチェック

2. **データ形式確認**
   - 鳥種別のCSV形式に合わせて整理（システムが自動で行う）
   - 数値データの妥当性を目視確認

#### システムアップロード手順
1. **アップロード開始**
   - 管理画面「CSV アップロード」
   - **生産者選択/一括アップロード**
     - 検索ボックスで**工場名**で検索
     - 鳥種フィルタで絞り込み
     - 地域ブロックフィルタで絞り込み
     - 対象生産者を選択

2. **ファイルアップロード**
   - CSVファイルを選択
   - ファイル形式・文字コード自動判定
   - **リアルタイム検証**
     - ファイル形式チェック
     - データ項目チェック
     - 数値範囲チェック
     - 必須項目チェック

3. **データ確認画面**
   - **アップロード内容プレビュー（例）**
     ```
     生産者: ○○養鶏場（ブロイラー）
     提出月: 2025年7月分
     申請者: 山田太郎（営業部）
     
     データ内容:
     - ひな導入実績: 1,500.5千羽
     - 処理羽数実績: 1,400.2千羽
     - 処理重量実績: 3.2トン
     ※その他項目表示...
     ```
   
   - **警告・エラー表示**
     ```
     ⚠️ 警告
     - 導入数より処理数が多い可能性があります
     - 前年度の月データと比較して大きな変動があります
     
     ❌ エラー
     - 翌月予定が未入力です
     ```

4. **最終確認・修正/登録**
   - 職員確認チェックボックス：「データ内容を確認し、正しい生産者のデータであることを確認しました」
   - 「登録実行」ボタンで確定
   - 登録完了メッセージ表示
